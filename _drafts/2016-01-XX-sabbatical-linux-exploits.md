---
layout: post
title: "Sabbatical Reading List: Linux x64 Exploits"
comments: true
permalink: "sabbatical-linux-x64-exploits"
---

### Linux x86 Exploit Tutorial Series

As a software engineer who (presumably) does their homework, one knows that
many things that make your program crash can also make your program
exploitable, and so naturally a lot of energy goes into avoiding those
conditions - don't use-after-free, don't leak variables from the stack, yadda
yadda.

But of course the other side of the coin - how to exploit these conditions - is
interesting in its own right and a great way to understand better of computers
**really** work at a low level. Most probably have a basic idea - change the
return address to jump to code that syscalls and gives you a shell - but in
reality trivial attacks like this are rarely possible and one must use more
more and more sophisticated and quite creative techniques.

A great starter for a deep-dive into the real world of Linux exploits is the
aptly named [Linux x86 Exploit Development Tutorial
Series](https://sploitfun.wordpress.com/2015/06/26/linux-x86-exploit-development-tutorial-series/)
by author [sploitfun](https://sploitfun.wordpress.com): Starting from the
classic stack and heap overflows, it quickly becomes more interesting and
addresses bypassing, among others, memory-based protection and address
randomization.

Armed with that knowledge, it's time to look at a real exploit, dissected:
[tinyhack](http://tinyhack.com)'s [analysis of the *towelroot
exploit*](http://tinyhack.com/2014/07/07/exploiting-the-futex-bug-and-uncovering-towelroot/)

The TL;DR here is that a kernel bug puts stack-allocated memory in a list, so
that by invoking an adequately nested function call, that list element can
later be modified, but that really makes it look way too easy. It's fascinating
to see the expertise and tenacity needed to architect this exploit.

Another good read is [Stack Jacking - Your Way To GRSec/Pax Bypass
(2011)](https://jon.oberheide.org/blog/2011/04/20/stackjacking-your-way-to-grsec-pax-bypass/), which is interesting in that it explicitly attacks a hardened
flavor of Linux; a lot of work goes into discovery of the kernel stack, and
escalating privileges from there, with quite a few obstacles to navigate.

And finally, to top it off with Chrome exploits, there's [Pinkie Pie's chaining
of six different bugs to break out of the sandbox](https://blog.chromium.org/2012/05/tale-of-two-pwnies-part-1.html) as well as his [64-bit
exploit](https://scarybeastsecurity.blogspot.com.ar/2013/02/exploiting-64-bit-linux-like-boss.html), awarded a $50.000 bounty by Google in 2012.

Of course, there's much more out there, and looking into some of the above is
likely to lead to hours spent reading up on random things. You've been warned.

